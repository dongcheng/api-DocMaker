package com.melonlee.api.controller;import java.util.ArrayList;import javax.annotation.Resource;import org.springframework.stereotype.Controller;import org.springframework.ui.ModelMap;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.servlet.ModelAndView;import com.melonlee.api.bean.FunctionBean;import com.melonlee.api.dao.MainDao;import com.melonlee.api.utils.DateFormatUtils;@Controllerpublic class FunctionController {	@Resource	private MainDao mainDao;	private int pID;	@RequestMapping(value = "saveFun", method = RequestMethod.POST)	public ModelAndView save(			@RequestParam(value = "id", required = false) int id,			@RequestParam(value = "pID", required = false) int pID,			@RequestParam(value = "mID", required = false) int mID,			@RequestParam(value = "title", required = false) String title,			@RequestParam(value = "url", required = false) String url,			@RequestParam(value = "httpMethod", required = false) String httpMethod,			@RequestParam(value = "isLogin", required = false) int isLogin,			@RequestParam(value = "params", required = false) String params) {		FunctionBean bean = new FunctionBean();		bean.setCreateDate(DateFormatUtils.getNow());		bean.setHttpMethod(httpMethod);		bean.setIsLogin(isLogin);		bean.setmID(mID);		bean.setParams(DateFormatUtils.enCoding(params));		bean.setTitle(DateFormatUtils.enCoding(title));		bean.setUrl(url);		bean.setId(id);		if (id > 0) {			mainDao.updateFun(bean);		} else {			mainDao.saveFun(bean);		}		this.pID = pID;		return funs(mID);	}	@RequestMapping(value = "funs", method = RequestMethod.GET)	public ModelAndView funs(			@RequestParam(value = "mID", required = false) int mID) {		ArrayList<FunctionBean> funs = mainDao.getFuns(mID);		ModelMap model = new ModelMap();		model.addAttribute("funs", funs);		model.addAttribute("mID", mID);		model.addAttribute("pID", this.pID);		return new ModelAndView("functions.jsp", model);	}	@RequestMapping(value = "getFun", method = RequestMethod.GET)	public ModelAndView getFun(			@RequestParam(value = "id", required = false) int id) {		FunctionBean fun = mainDao.getFun(id);		ModelMap model = new ModelMap();		model.addAttribute("fun", fun);		return new ModelAndView("createFun.jsp", model);	}	@RequestMapping(value = "delFun", method = RequestMethod.GET)	public ModelAndView getFun(			@RequestParam(value = "id", required = false) int id,			@RequestParam(value = "mID", required = false) int mID) {		mainDao.delFun(id);		return funs(mID);	}}
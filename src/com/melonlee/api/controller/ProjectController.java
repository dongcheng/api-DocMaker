package com.melonlee.api.controller;import java.util.ArrayList;import javax.annotation.Resource;import org.springframework.stereotype.Controller;import org.springframework.ui.ModelMap;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.servlet.ModelAndView;import com.melonlee.api.bean.ModuleBean;import com.melonlee.api.bean.ProjectBean;import com.melonlee.api.dao.MainDao;import com.melonlee.api.utils.DateFormatUtils;@Controllerpublic class ProjectController {	@Resource	private MainDao mainDao;	@RequestMapping(value = "savePro", method = RequestMethod.POST)	public ModelAndView save(			@RequestParam(value = "id", required = false) int id,			@RequestParam(value = "title", required = false) String title,			@RequestParam(value = "baseUrl", required = false) String baseUrl,			@RequestParam(value = "descStr", required = false) String descStr,			@RequestParam(value = "version", required = false) String version) {				Integer proID = id;				if(proID>0){						mainDao.updatePro(id,DateFormatUtils.enCoding(title),					DateFormatUtils.enCoding(baseUrl),					DateFormatUtils.enCoding(descStr),version);		}else{			  proID = mainDao.createPro(DateFormatUtils.enCoding(title),						DateFormatUtils.enCoding(baseUrl),						DateFormatUtils.enCoding(descStr),version);				ModelMap model = new ModelMap();				model.addAttribute("proID", proID);				model.addAttribute("proName", DateFormatUtils.enCoding(title));				return new ModelAndView("modules.jsp", model);									}		ModelMap model = new ModelMap();		model.addAttribute("proID", proID);		model.addAttribute("proName", DateFormatUtils.enCoding(title));		return new ModelAndView( id>0? "pros.do" : "modules.jsp", model);	}	@RequestMapping(value = "pros", method = {RequestMethod.GET,RequestMethod.POST})	public ModelAndView pros() {		ArrayList<ProjectBean> pros = mainDao.getPros();		ModelMap model = new ModelMap();		model.addAttribute("pros", pros);		return new ModelAndView("pros.jsp", model);	}			@RequestMapping(value = "getPro", method = RequestMethod.GET)	public ModelAndView getPro(			@RequestParam(value = "id", required = false) int id) {				ProjectBean pro = mainDao.getPro(id);		ModelMap model = new ModelMap();		model.addAttribute("pro", pro);		return new ModelAndView("createPro.jsp", model);	}			/*	 * 生成文档内容 查询 pro,module,functions	 */	@RequestMapping(value = "createDoc", method = RequestMethod.GET)	public ModelAndView pros(			@RequestParam(value = "pID", required = false) int pID) {				ProjectBean pro = mainDao.getPro(pID);				ArrayList<ModuleBean> modules = mainDao.getModulesByPro(pro.getId());		pro.setModules(modules);				ModelMap model = new ModelMap();		model.addAttribute("pro", pro);		return new ModelAndView("apiBase.jsp", model);	}	}